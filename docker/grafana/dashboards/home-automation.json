{
  "dashboard": {
    "annotations": {"list": []},
    "editable": true,
    "gnetId": null,
    "graphTooltip": 0,
    "id": null,
    "links": [],
    "panels": [
      {
        "title": "DS1 - Door",
        "type": "timeseries",
        "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
        "id": 1,
        "targets": [
          {
            "refId": "A",
            "query": "from(bucket:\"sensors\") |> range(start: -1h) |> filter(fn: (r) => r._measurement == \"DS1\" and r[\"device_id\"] == \"$device_id\") |> last()"
          }
        ]
      },
      {
        "title": "DUS1 - Distance",
        "type": "timeseries",
        "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0},
        "id": 2,
        "targets": [
          {"refId": "A", "query": "from(bucket:\"sensors\") |> range(start: -1h) |> filter(fn: (r) => r._measurement == \"DUS1\" and r[\"device_id\"] == \"$device_id\") |> aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)"}
        ]
      },
      {
        "title": "DPIR1 - Motion",
        "type": "stat",
        "gridPos": {"h": 4, "w": 6, "x": 0, "y": 8},
        "id": 4,
        "targets": [
          {"refId": "A", "query": "from(bucket:\"sensors\") |> range(start: -1h) |> filter(fn: (r) => r._measurement == \"DPIR1\") |> filter(fn: (r) => r[\"device_id\"] == \"$device_id\") |> last()"}
        ]
      },
      {
        "title": "DL - LED State",
        "type": "stat",
        "gridPos": {"h": 4, "w": 6, "x": 6, "y": 8},
        "id": 5,
        "targets": [
          {"refId": "A", "query": "from(bucket:\"sensors\") |> range(start: -1h) |> filter(fn: (r) => r._measurement == \"DL\") |> filter(fn: (r) => r[\"device_id\"] == \"$device_id\") |> last()"}
        ]
      },
      {
        "title": "DB - Buzzer State",
        "type": "stat",
        "gridPos": {"h": 4, "w": 6, "x": 12, "y": 8},
        "id": 6,
        "targets": [
          {"refId": "A", "query": "from(bucket:\"sensors\") |> range(start: -1h) |> filter(fn: (r) => r._measurement == \"DB\") |> filter(fn: (r) => r[\"device_id\"] == \"$device_id\") |> last()"}
        ]
      },
      {
        "title": "DMS - Membrane",
        "type": "stat",
        "gridPos": {"h": 4, "w": 6, "x": 18, "y": 8},
        "id": 7,
        "targets": [
          {"refId": "A", "query": "from(bucket:\"sensors\") |> range(start: -1h) |> filter(fn: (r) => r._measurement == \"DMS\") |> filter(fn: (r) => r[\"device_id\"] == \"$device_id\") |> last()"}
        ]
      },
      {
        "title": "Actuator Control",
        "type": "grafana-button-panel",
        "gridPos": {"h": 4, "w": 24, "x": 0, "y": 12},
        "id": 3,
        "options": {
          "buttons": [
            {
              "label": "LED ON",
              "method": "POST",
              "url": "http://app:5000/actuator/$device_id/led",
              "payload": "{ \"state\": \"on\" }",
              "headers": {"Content-Type": "application/json"}
            },
            {
              "label": "LED OFF",
              "method": "POST",
              "url": "http://app:5000/actuator/$device_id/led",
              "payload": "{ \"state\": \"off\" }",
              "headers": {"Content-Type": "application/json"}
            },
            {
              "label": "BUZZER ON",
              "method": "POST",
              "url": "http://app:5000/actuator/$device_id/buzzer",
              "payload": "{ \"state\": \"on\" }",
              "headers": {"Content-Type": "application/json"}
            }
          ]
        }
      }
    ],
    "refresh": "5s",
    "schemaVersion": 30,
    "style": "dark",
    "tags": [],
    "templating": {"list": [
      {
        "type": "custom",
        "name": "device_id",
        "label": "Device",
        "query": "PI1",
        "current": {"text": "PI1", "value": "PI1"}
      },
      {
        "type": "custom",
        "name": "actuator_type",
        "label": "Actuator",
        "query": "led,buzzer",
        "current": {"text": "led", "value": "led"}
      }
    ]},

    "time": {"from": "now-1h", "to": "now"},
    "timepicker": {"refresh_intervals": ["5s", "10s", "30s", "1m", "5m", "15m"], "time_options": ["5m", "15m", "1h", "6h", "12h", "24h", "2d", "7d", "30d"]},
    "timezone": "browser",
    "title": "Home Automation",
    "version": 1
  },
  "overwrite": true
}
